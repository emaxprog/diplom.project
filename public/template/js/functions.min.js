$(document).ready(function(){function k(){for(var a=JSON.parse($.cookie("basket")),b=0,c=0;c<a.length;c++)b+=a[c].price*a[c].amount;return b}function f(){$(".total-cost").html("<span>\u041e\u0431\u0449\u0430\u044f \u0441\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c: "+k()+" \u0440\u0443\u0431.</span>")}function g(){for(var a=$.cookie("basket"),a=JSON.parse(a),b=0,c=0;c<a.length;c++)b+=parseInt(a[c].amount);$(".count-products").html(b)}$("#tabs").tabs();$(".buy-btn").click(function(){var a=parseInt($(this).attr("data-id")),
    b=$(this).attr("data-name"),c=parseInt($(this).attr("data-price")),e=$("#img-"+a).attr("src"),d=$.cookie("basket")?$.cookie("basket"):null;d?d=JSON.parse(d):d=[];if(d.length){for(var f=!1,h=0;h<d.length;h++)if(d[h].productId==a){d[h].amount++;f=!0;break}f||d.push({productId:a,name:b,price:c,img:e,amount:1})}else d.push({productId:a,name:b,price:c,img:e,amount:1});$.cookie("basket",JSON.stringify(d));g()});$(".input-total-price").bind("change keyup",function(){var a=$(this).val();if(!a.match(/[0-9]+/)||
    0>=a)$(this).val("1"),a=1;var b=$(this).parent().parent().attr("data-id"),c=$(this).parent().prev().html();$(this).parent().next().html(a*c);for(var c=JSON.parse($.cookie("basket")),e=0;e<c.length;e++)if(c[e].productId==b){c[e].amount=a;break}$.cookie("basket",JSON.stringify(c));g();f()});$(".btn-delete").click(function(){var a=$(this).parent().parent(),b=$(this).parent().parent().attr("data-id");a.remove();for(var a=JSON.parse($.cookie("basket")),c=0;c<a.length;c++)if(a[c].productId==b){a.splice(c,
    1);break}$.cookie("basket",JSON.stringify(a));1>a.length&&($.removeCookie("basket"),location.reload());g();f()});$(".btn-plus").click(function(){$(this).siblings(".input-total-price").val(parseInt($(this).siblings(".input-total-price").val())+1).change()});$(".btn-minus").click(function(){$(this).siblings(".input-total-price").val(parseInt($(this).siblings(".input-total-price").val())-1).change()});$("#btn-add-parameters").click(function(){var a=$(this);$.ajax({url:"/admin/product_attributes",type:"GET",
    headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(b){a.after(b)},error:function(a){console.log(a)}})});$(".delete-product").click(function(){var a=$(this).parent().parent(),b=$(this).attr("data-id");$.ajax({url:"/admin/product/"+b,type:"DELETE",data:{product_id:b},headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(c){a.remove()},error:function(a){console.log(a)}})});$(".delete-category").click(function(){var a=$(this).parent().parent(),
    b=a.attr("data-id");$.ajax({url:"/admin/category/"+b,type:"DELETE",data:{category_id:b},headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(){a.remove()},error:function(a){console.log(a)}})});$(".delete-order").click(function(){var a=$(this).parent().parent(),b=a.attr("data-id");$.ajax({url:"/admin/order/"+b,type:"DELETE",data:{order_id:b},headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(){a.remove()},error:function(a){console.log(a)}})});
    $(document).on("click","#btn-remove-parameter",function(){var a;confirm("\u0423\u0434\u0430\u043b\u0438\u0442\u044c?")&&(a=$(this).parent(),a.remove())});$(document).on("click","#btn-add-parameter",function(){$("#myModal").dialog({modal:!0,height:300,width:500})});$(document).on("click","#btn-close",function(){$("#myModal").dialog("close")});$(document).on("click","#btn-save",function(){var a=$('input[name="attribute-name"]').val(),b=$('input[name="unit"]').val();$.ajax({url:"/admin/product_attributes",
        type:"POST",data:{name:a,unit:b},headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(a){$('select[name="parameter"]').append('<option value="'+a.id+'">'+a.name+"("+a.unit+")</option>");$("#myModal").dialog("close")},error:function(a){console.log(a)}})});$(".add-images-products").click(function(){var a=$("img"),b=$('input[name="images[]"]');11!=a.length+b.length&&(a=$('input[name="images[]"]:first').clone(),$(this).after(a),$(this).after("<br>"))});$(".delete-image").click(function(){var a=
        $(this).parent(),b=$(this).prev(),c=b.attr("src"),b=b.attr("data-id");$.ajax({url:"/delete_image",type:"POST",data:{src:c,product_id:b},headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(b){a.remove()},error:function(a){console.log(a)}})});$("#add-image-afisha").click(function(){var a=$("img"),b=$('input[name="images[]"]');10!=a.length+b.length&&($(this).after('<input type="file" name="images[]">'),$(this).after("<br>"))});$(".delete-image-afisha").click(function(){var a=
        $(this).parent(),b=$(this).prev().attr("src");$.ajax({url:"/admin/afisha/destroy",type:"DELETE",data:{src:b},headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(b){a.remove()},error:function(a){console.log(a)}})});f();g()});